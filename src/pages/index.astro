---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";

const postsCollection: "posts" | "postsRu" = "posts";
const pageTitle = "Nafty - Engineer & Builder";
const allPosts = await getCollection(postsCollection);
const recentPosts = allPosts.slice(0, 3);
---

<BaseLayout pageTitle={pageTitle} hideTitle={true}>
  <section class="min-h-[60vh] flex flex-col justify-center py-12 md:py-20">
    <div class="max-w-4xl">
      <h1 class="text-5xl md:text-7xl font-black tracking-tighter mb-6 leading-none">
        Nafty
      </h1>
      <p class="text-xl md:text-2xl mb-8 max-w-2xl leading-relaxed">
        Engineer, reverse engineer, and builder. I ship <span class="font-bold text-[var(--accent)]">bold</span>, <span class="font-bold text-[var(--accent)]">fast</span>, <span class="font-bold text-[var(--accent)]">accessible</span> software.
      </p>
      <div class="flex flex-wrap gap-4">
        <a 
          href="/blog" 
          class="px-6 py-3 bg-[var(--accent)] text-[var(--bg)] font-bold border-4 border-[var(--border)] rounded-lg shadow-[4px_4px_0_0_var(--border)] hover:shadow-[2px_2px_0_0_var(--border)] hover:translate-x-0.5 hover:translate-y-0.5 transition-all"
        >
          Read the blog →
        </a>
        <a 
          href="/about" 
          class="px-6 py-3 bg-[var(--bg)] text-[var(--fg)] font-bold border-4 border-[var(--border)] rounded-lg shadow-[4px_4px_0_0_var(--border)] hover:shadow-[2px_2px_0_0_var(--border)] hover:translate-x-0.5 hover:translate-y-0.5 transition-all"
        >
          About me
        </a>
      </div>
    </div>
  </section>

  <section class="py-12 md:py-16">
    <h2 class="text-3xl md:text-4xl font-black mb-8">Recent Posts</h2>
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {recentPosts.map(post => (
        <a 
          href={`/posts/${post.slug}`}
          class="group block p-6 border-4 border-[var(--border)] rounded-lg bg-[var(--bg)] shadow-[4px_4px_0_0_var(--border)] hover:shadow-[6px_6px_0_0_var(--border)] hover:-translate-x-0.5 hover:-translate-y-0.5 transition-all"
        >
          <div class="aspect-video mb-4 overflow-hidden rounded border-2 border-[var(--border)]">
            <img 
              src={post.data.image.url} 
              alt={post.data.image.alt}
              class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              loading="lazy"
            />
          </div>
          <h3 class="font-black text-xl mb-2 group-hover:text-[var(--accent)] transition-colors">{post.data.title}</h3>
          <p class="text-sm opacity-70 mb-3">{post.data.pubDate.toLocaleDateString('en', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
          <p class="line-clamp-2">{post.data.description}</p>
        </a>
      ))}
    </div>
    <div class="mt-8 text-center">
      <a 
        href="/blog"
        class="inline-block px-6 py-3 font-bold border-4 border-[var(--border)] rounded-lg hover:bg-[var(--accent)] hover:text-[var(--bg)] transition-colors"
      >
        View all posts →
      </a>
    </div>
  </section>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
